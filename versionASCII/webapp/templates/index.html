<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Laberinto - Web Scaffold</title>
    <style>
      body { font-family: system-ui, sans-serif; padding: 1rem; }
      #log { white-space: pre-wrap; background:#111; color:#eee; padding:1rem; height:300px; overflow:auto }
      input, button { padding:0.5rem; margin:0.25rem }
    </style>
  </head>
  <body>
    <h1>Laberinto - Web Scaffold</h1>
    <div>
      <button id="start">Iniciar Juego</button>
      <input id="seed" placeholder="seed (opcional)" />
    </div>

    <div style="margin-top:1rem">
      <input id="action" placeholder="acción (ej: N, S, E, O, HELP, atacar)" />
      <button id="send">Enviar Acción</button>
    </div>

    <h2>Estado</h2>
    <div id="log">Estado inicial.</div>

    <script>
      let session = null;
      document.getElementById('start').onclick = async () => {
        const seed = document.getElementById('seed').value || undefined;
        const res = await fetch('/api/start', {method:'POST', headers:{'content-type':'application/json'}, body: JSON.stringify({seed})});
        const data = await res.json();
        session = data.session_id;
        document.getElementById('log').textContent = JSON.stringify(data.state, null, 2);
      }

      document.getElementById('send').onclick = async () => {
        if (!session) { alert('Inicia una sesión primero'); return }
        const action = document.getElementById('action').value || '';
        const res = await fetch('/api/action', {method:'POST', headers:{'content-type':'application/json'}, body: JSON.stringify({session_id: session, action})});
        const data = await res.json();
        document.getElementById('log').textContent = JSON.stringify(data.state, null, 2);
      }
    </script>
  </body>
</html>
